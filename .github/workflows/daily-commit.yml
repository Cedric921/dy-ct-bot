name: Daily Verified Commit

on:
  schedule:
    - cron: '23 7 * * 1-6'  # Random hour in morning Mon-Sat
    - cron: '18 14 * * 1-6' # Random hour in afternoon Mon-Sat
  workflow_dispatch:

jobs:
  commit:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout main branch
        uses: actions/checkout@v3
        with:
          token: ${{ secrets.GH_SIGNED_TOKEN }}
          fetch-depth: 0

      - name: Make a daily change
        run: |
          echo "Ping at $(date -u)" >> activity.log

      - name: Configure git
        run: |
          git config user.name "C√©dric Karungu"
          git config user.email "ckarungu921@gmail.com"
          git config commit.gpgsign true
          git config user.signingkey "C√©dric Karungu"

      - name: Commit and push
        env:
          GH_TOKEN: ${{ secrets.GH_SIGNED_TOKEN }}
        run: |
          git pull --rebase origin main
          git add activity.log
          git commit -S -m "üîÅ Auto ping at $(date -u)" || echo "No changes to commit"
          git push origin main
